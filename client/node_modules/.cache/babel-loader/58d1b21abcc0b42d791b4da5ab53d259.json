{"ast":null,"code":"import { findTabbableDescendants } from './tabbable.js';\nconst focusLaterElements = [];\nlet focusElement = null;\nlet needToFocus = false;\n\nfunction handleBlur() {\n  needToFocus = true;\n}\n\nfunction handleFocus() {\n  if (needToFocus) {\n    needToFocus = false;\n\n    if (!focusElement) {\n      return;\n    }\n\n    if (focusElement.contains(document.activeElement)) {\n      return;\n    }\n\n    const el = findTabbableDescendants(focusElement)[0] || focusElement;\n    el.focus();\n  }\n}\n\nfunction markForFocusLater() {\n  focusLaterElements.push(document.activeElement);\n}\n\nfunction returnFocus() {\n  let toFocus = null;\n\n  try {\n    toFocus = focusLaterElements.pop();\n    if (toFocus) toFocus.focus();\n  } catch (e) {\n    console.warn([\"[@mantine/hooks/use-focus-trap] Focus was returned to\", toFocus, \"but dom node does not exist\"].join(\" \"));\n  }\n}\n\nfunction setupScopedFocus(element) {\n  focusElement = element;\n  document.addEventListener(\"focusout\", handleBlur, false);\n  document.addEventListener(\"focusin\", handleFocus, true);\n}\n\nfunction teardownScopedFocus() {\n  focusElement = null;\n  document.removeEventListener(\"focusout\", handleBlur);\n  document.removeEventListener(\"focusin\", handleFocus);\n}\n\nexport { markForFocusLater, returnFocus, setupScopedFocus, teardownScopedFocus };","map":{"version":3,"sources":["../../src/use-focus-trap/focus-manager.ts"],"names":[],"mappings":";AACA,MAAM,kBAAkB,GAAG,EAA3B;AACA,IAAI,YAAY,GAAG,IAAnB;AACA,IAAI,WAAW,GAAG,KAAlB;;AACA,SAAS,UAAT,GAAsB;AACpB,EAAA,WAAW,GAAG,IAAd;AACD;;AACD,SAAS,WAAT,GAAuB;AACrB,MAAI,WAAJ,EAAiB;AACf,IAAA,WAAW,GAAG,KAAd;;AACA,QAAI,CAAC,YAAL,EAAmB;AACjB;AACD;;AACD,QAAI,YAAY,CAAC,QAAb,CAAsB,QAAQ,CAAC,aAA/B,CAAJ,EAAmD;AACjD;AACD;;AACD,UAAM,EAAE,GAAG,uBAAuB,CAAC,YAAD,CAAvB,CAAsC,CAAtC,KAA4C,YAAvD;AACA,IAAA,EAAE,CAAC,KAAH;AACD;AACF;;AACM,SAAS,iBAAT,GAA6B;AAClC,EAAA,kBAAkB,CAAC,IAAnB,CAAwB,QAAQ,CAAC,aAAjC;AACD;;AACM,SAAS,WAAT,GAAuB;AAC5B,MAAI,OAAO,GAAG,IAAd;;AACA,MAAI;AACF,IAAA,OAAO,GAAG,kBAAkB,CAAC,GAAnB,EAAV;AACA,QAAI,OAAJ,EACE,OAAO,CAAC,KAAR;AACH,GAJD,CAIE,OAAO,CAAP,EAAU;AACV,IAAA,OAAO,CAAC,IAAR,CAAa,CACX,uDADW,EAEX,OAFW,EAGX,6BAHW,EAIX,IAJW,CAIN,GAJM,CAAb;AAKD;AACF;;AACM,SAAS,gBAAT,CAA0B,OAA1B,EAAmC;AACxC,EAAA,YAAY,GAAG,OAAf;AACA,EAAA,QAAQ,CAAC,gBAAT,CAA0B,UAA1B,EAAsC,UAAtC,EAAkD,KAAlD;AACA,EAAA,QAAQ,CAAC,gBAAT,CAA0B,SAA1B,EAAqC,WAArC,EAAkD,IAAlD;AACD;;AACM,SAAS,mBAAT,GAA+B;AACpC,EAAA,YAAY,GAAG,IAAf;AACA,EAAA,QAAQ,CAAC,mBAAT,CAA6B,UAA7B,EAAyC,UAAzC;AACA,EAAA,QAAQ,CAAC,mBAAT,CAA6B,SAA7B,EAAwC,WAAxC;AACF","sourcesContent":["import { findTabbableDescendants } from './tabbable';\n\nconst focusLaterElements: HTMLElement[] = [];\nlet focusElement: HTMLElement = null;\nlet needToFocus = false;\n\nfunction handleBlur() {\n  needToFocus = true;\n}\n\nfunction handleFocus() {\n  if (needToFocus) {\n    needToFocus = false;\n\n    if (!focusElement) {\n      return;\n    }\n\n    if (focusElement.contains(document.activeElement)) {\n      return;\n    }\n\n    const el = findTabbableDescendants(focusElement)[0] || focusElement;\n    el.focus();\n  }\n}\n\nexport function markForFocusLater() {\n  focusLaterElements.push(document.activeElement as HTMLElement);\n}\n\nexport function returnFocus() {\n  let toFocus = null;\n  try {\n    toFocus = focusLaterElements.pop();\n    if (toFocus) toFocus.focus();\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.warn(\n      [\n        '[@mantine/hooks/use-focus-trap] Focus was returned to',\n        toFocus,\n        'but dom node does not exist',\n      ].join(' ')\n    );\n  }\n}\n\nexport function setupScopedFocus(element: HTMLElement) {\n  focusElement = element;\n  document.addEventListener('focusout', handleBlur, false);\n  document.addEventListener('focusin', handleFocus, true);\n}\n\nexport function teardownScopedFocus() {\n  focusElement = null;\n  document.removeEventListener('focusout', handleBlur);\n  document.removeEventListener('focusin', handleFocus);\n}\n"]},"metadata":{},"sourceType":"module"}