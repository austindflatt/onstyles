{"version":3,"file":"Menu.js","sources":["../../../src/components/Menu/Menu.tsx"],"sourcesContent":["import React, { useState, useRef, cloneElement, forwardRef } from 'react';\nimport {\n  useClickOutside,\n  useMergedRef,\n  useWindowEvent,\n  useUncontrolled,\n  useUuid,\n} from '@mantine/hooks';\nimport {\n  DefaultProps,\n  MantineNumberSize,\n  MantineShadow,\n  ClassNames,\n  MantineMargin,\n} from '@mantine/styles';\nimport { ActionIcon } from '../ActionIcon/ActionIcon';\nimport { Popper, SharedPopperProps } from '../Popper/Popper';\nimport { MenuIcon } from './MenuIcon';\nimport { MenuBody, MenuBodyStylesNames } from './MenuBody/MenuBody';\nimport { MenuItem, MenuItemComponent } from './MenuItem/MenuItem';\nimport { MenuLabel, MenuLabelProps } from './MenuLabel/MenuLabel';\nimport useStyles from './Menu.styles';\n\nexport type MenuStylesNames = ClassNames<typeof useStyles> | MenuBodyStylesNames;\n\nexport interface MenuProps\n  extends Omit<DefaultProps<MenuStylesNames>, MantineMargin>,\n    SharedPopperProps,\n    React.ComponentPropsWithoutRef<'div'> {\n  /** <MenuItem /> and <Divider /> components only, children are passed to MenuBody component  */\n  children: React.ReactNode;\n\n  /** React element that will be used as menu control */\n  control?: React.ReactElement;\n\n  /** Use opened and onClose props to setup controlled menu */\n  opened?: boolean;\n\n  /** Called every time menu is closed */\n  onClose?(): void;\n\n  /** Called every time menu is opened */\n  onOpen?(): void;\n\n  /** Menu button aria-label and title props */\n  menuButtonLabel?: string;\n\n  /** MenuBody component props */\n  menuBodyProps?: React.ComponentPropsWithoutRef<'div'> & { [key: string]: any };\n\n  /** Predefined menu width or number for width in px */\n  size?: MantineNumberSize;\n\n  /** Predefined shadow from theme or box-shadow value */\n  shadow?: MantineShadow;\n\n  /** Should menu close on item click */\n  closeOnItemClick?: boolean;\n\n  /** Id attribute of menu */\n  menuId?: string;\n\n  /** Control prop to get element ref */\n  controlRefProp?: string;\n\n  /** Menu body z-index */\n  zIndex?: number;\n\n  /** Event which should open menu */\n  trigger?: 'click' | 'hover';\n\n  /** Close delay for hover trigger */\n  delay?: number;\n\n  /** Menu body and items border-radius */\n  radius?: MantineNumberSize;\n\n  /** Close menu on scroll */\n  closeOnScroll?: boolean;\n\n  /** Trap focus inside menu */\n  trapFocus?: boolean;\n}\n\nconst defaultControl = (\n  <ActionIcon>\n    <MenuIcon />\n  </ActionIcon>\n);\n\ntype MenuComponent = {\n  displayName?: string;\n  Item: MenuItemComponent;\n  Label: React.FC<MenuLabelProps>;\n} & ((props: MenuProps) => React.ReactElement);\n\nexport const Menu: MenuComponent = forwardRef<HTMLButtonElement, MenuProps>(\n  (\n    {\n      control = defaultControl,\n      children,\n      onClose,\n      onOpen,\n      opened,\n      style,\n      menuId,\n      menuBodyProps = {},\n      closeOnItemClick = true,\n      transitionDuration = 250,\n      size = 'md',\n      shadow = 'md',\n      position = 'bottom',\n      placement = 'start',\n      gutter = 5,\n      withArrow = false,\n      transition = 'pop-top-left',\n      transitionTimingFunction,\n      menuButtonLabel,\n      controlRefProp = 'ref',\n      trigger = 'click',\n      radius = 'sm',\n      delay = 0,\n      zIndex = 1,\n      classNames,\n      styles,\n      closeOnScroll = true,\n      trapFocus = true,\n      onMouseLeave,\n      onMouseEnter,\n      onChange,\n      ...others\n    }: MenuProps,\n    ref\n  ) => {\n    const { classes } = useStyles(null, { classNames, styles, name: 'Menu' });\n    const delayTimeout = useRef<number>();\n    const [referenceElement, setReferenceElement] = useState<HTMLButtonElement>(null);\n    const [wrapperElement, setWrapperElement] = useState<HTMLDivElement>(null);\n    const [dropdownElement, setDropdownElement] = useState<HTMLDivElement>(null);\n    const uuid = useUuid(menuId);\n\n    const [_opened, setOpened] = useUncontrolled({\n      value: opened,\n      defaultValue: false,\n      finalValue: false,\n      rule: (val) => typeof val === 'boolean',\n      onChange: (value) =>\n        value\n          ? typeof onOpen === 'function' && onOpen()\n          : typeof onClose === 'function' && onClose(),\n    });\n\n    const openedRef = useRef(_opened);\n\n    const handleClose = () => {\n      if (openedRef.current) {\n        openedRef.current = false;\n        setOpened(false);\n      }\n    };\n\n    const handleOpen = () => {\n      openedRef.current = true;\n      setOpened(true);\n    };\n\n    useWindowEvent('scroll', () => closeOnScroll && handleClose());\n\n    useClickOutside(() => _opened && handleClose(), null, [dropdownElement, wrapperElement]);\n\n    const toggleMenu = () => {\n      _opened ? handleClose() : handleOpen();\n    };\n\n    const controlEventHandlers =\n      trigger === 'click'\n        ? { onClick: toggleMenu }\n        : { onMouseEnter: handleOpen, onFocus: handleOpen };\n\n    const handleMouseLeave = (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n      typeof onMouseLeave === 'function' && onMouseLeave(event);\n\n      if (trigger === 'hover') {\n        if (delay > 0) {\n          delayTimeout.current = window.setTimeout(() => handleClose(), delay);\n        } else {\n          handleClose();\n        }\n      }\n    };\n\n    const handleMouseEnter = (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n      typeof onMouseEnter === 'function' && onMouseEnter(event);\n      window.clearTimeout(delayTimeout.current);\n    };\n\n    const menuControl = cloneElement(control, {\n      ...controlEventHandlers,\n      role: 'button',\n      'aria-haspopup': 'menu',\n      'aria-expanded': _opened,\n      'aria-controls': uuid,\n      'aria-label': menuButtonLabel,\n      title: menuButtonLabel,\n      [controlRefProp]: useMergedRef(setReferenceElement, ref),\n    });\n\n    return (\n      <div\n        ref={setWrapperElement}\n        style={{ display: 'inline-block', position: 'relative', ...style }}\n        onMouseLeave={handleMouseLeave}\n        onMouseEnter={handleMouseEnter}\n        {...others}\n      >\n        {menuControl}\n\n        <Popper\n          referenceElement={referenceElement}\n          transitionDuration={transitionDuration}\n          transitionTimingFunction={transitionTimingFunction}\n          transition={transition}\n          mounted={_opened}\n          position={position}\n          placement={placement}\n          gutter={gutter}\n          withArrow={withArrow}\n          arrowSize={3}\n          zIndex={zIndex}\n          arrowClassName={classes.arrow}\n        >\n          <MenuBody\n            {...menuBodyProps}\n            opened={_opened}\n            onClose={handleClose}\n            id={uuid}\n            closeOnItemClick={closeOnItemClick}\n            size={size}\n            shadow={shadow}\n            classNames={classNames}\n            styles={styles}\n            radius={radius}\n            trapFocus={trigger !== 'hover' && trapFocus}\n            transitionDuration={transitionDuration}\n            ref={setDropdownElement}\n          >\n            {children}\n          </MenuBody>\n        </Popper>\n      </div>\n    );\n  }\n) as any;\n\nMenu.Item = MenuItem;\nMenu.Label = MenuLabel;\n\nMenu.displayName = '@mantine/core/Menu';\n"],"names":["React","ActionIcon","MenuIcon","forwardRef","useStyles","useRef","useState","useUuid","useUncontrolled","useWindowEvent","useClickOutside","cloneElement","useMergedRef","Popper","MenuBody","MenuItem","MenuLabel"],"mappings":"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"}